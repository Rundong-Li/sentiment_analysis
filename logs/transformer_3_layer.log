[INFO]: Vocabulary consists 20000 words.
[INFO]: Train Set Info.
Total sample num：37663
class num：
0 18747
1 18916
[INFO]: Valid Set Info.
Total sample num：12554
class num：
1 6407
0 6147
[INFO]: Test Set Info.
Total sample num：12555
class num：
1 6405
0 6150
[INFO]: Build Model: transformer

-------------------------- hyperparameters --------------------------------
learning_rate = 0.001 # 学习率
BATCH_SIZE = 128  # 训练批量
EPOCHS = 20  # 训练轮数
vocab_size = 20000  # 词汇表大小
hid_dim = 200  # embedding层隐向量维度
n_layers = 3   # EncoderLayer层数
n_heads = 8   # 多头自注意力head数
pf_dim = 256   # PositionwiseFeedFoward中间层的维度
dropout = 0.5  # dropout层
use_textcnn = False # 在transformer的输出上接上textcnn


----------------- [INFO]: Start Train and valid ------------------
train epoch: 1	average loss: 0.495644	accuracy:75.8941%
validation:train epoch: 1	average loss: 0.430738	 accuracy:84.21%
train epoch: 2	average loss: 0.328258	accuracy:86.2119%
validation:train epoch: 2	average loss: 0.318422	 accuracy:86.98%
train epoch: 3	average loss: 0.278843	accuracy:88.8910%
validation:train epoch: 3	average loss: 0.290168	 accuracy:88.59%
train epoch: 4	average loss: 0.254806	accuracy:89.8548%
validation:train epoch: 4	average loss: 0.276481	 accuracy:88.84%
train epoch: 5	average loss: 0.233419	accuracy:90.9327%
validation:train epoch: 5	average loss: 0.285550	 accuracy:88.49%
train epoch: 6	average loss: 0.169120	accuracy:93.8560%
validation:train epoch: 6	average loss: 0.277276	 accuracy:89.80%
train epoch: 7	average loss: 0.128237	accuracy:95.7199%
validation:train epoch: 7	average loss: 0.294982	 accuracy:89.67%
train epoch: 8	average loss: 0.098969	accuracy:96.8908%
validation:train epoch: 8	average loss: 0.316045	 accuracy:89.67%
train epoch: 9	average loss: 0.073883	accuracy:97.7909%
validation:train epoch: 9	average loss: 0.373964	 accuracy:89.29%
train epoch: 10	average loss: 0.055332	accuracy:98.4361%
validation:train epoch: 10	average loss: 0.410235	 accuracy:89.03%
train epoch: 11	average loss: 0.036496	accuracy:99.1212%
validation:train epoch: 11	average loss: 0.429480	 accuracy:89.06%
train epoch: 12	average loss: 0.029938	accuracy:99.3601%
validation:train epoch: 12	average loss: 0.452421	 accuracy:88.90%
train epoch: 13	average loss: 0.026032	accuracy:99.4291%
validation:train epoch: 13	average loss: 0.467529	 accuracy:88.83%
train epoch: 14	average loss: 0.023807	accuracy:99.4876%
validation:train epoch: 14	average loss: 0.478518	 accuracy:88.76%
train epoch: 15	average loss: 0.022213	accuracy:99.5407%
validation:train epoch: 15	average loss: 0.491620	 accuracy:88.78%
train epoch: 16	average loss: 0.019837	accuracy:99.6256%
validation:train epoch: 16	average loss: 0.494832	 accuracy:88.75%
train epoch: 17	average loss: 0.019637	accuracy:99.6283%
validation:train epoch: 17	average loss: 0.495273	 accuracy:88.74%
train epoch: 18	average loss: 0.019450	accuracy:99.6256%
validation:train epoch: 18	average loss: 0.497038	 accuracy:88.76%
train epoch: 19	average loss: 0.019228	accuracy:99.6336%
validation:train epoch: 19	average loss: 0.503870	 accuracy:88.79%
train epoch: 20	average loss: 0.019042	accuracy:99.6230%
validation:train epoch: 20	average loss: 0.500803	 accuracy:88.82%
------------------ [INFO]: Start Test ------------------------
test accuracy:89.54%.
